<!DOCTYPE html>
<html>
<head>
  <title>Fog Road Safety</title>
  <style>
    body {
      
      margin: 0;
      font-family: 'Arial Rounded MT Bold', Arial, sans-serif;
      background: linear-gradient(45deg, #0b1a20, #11232b);
      color: white;
      overflow: hidden;
    }

    h1 {
      text-align: center;
      padding: 25px;
      margin: 0;
      background: rgba(0, 0, 0, 0.4);
      font-size: 2.5em;
      text-shadow: 0 0 15px rgba(0, 188, 212, 0.5);
      animation: titleGlow 2s ease-in-out infinite alternate;
    }

    #map {
      width: 100%;
      height: 85vh;
      transition: all 0.3s ease;
      position: relative;
    }

    #alertBox {
      position: fixed;
      bottom: -100px;
      left: 50%;
      transform: translateX(-50%);
      padding: 20px 40px;
      background: linear-gradient(45deg, #ff4444, #cc0000);
      color: white;
      border-radius: 15px;
      font-weight: bold;
      box-shadow: 0 10px 30px rgba(255, 68, 68, 0.3);
      opacity: 0;
      transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      display: flex;
      align-items: center;
      gap: 15px;
    }

    #alertBox.active {
      bottom: 30px;
      opacity: 1;
    }

    #alertBox::before {
      content: '‚ö†Ô∏è';
      font-size: 1.5em;
      animation: pulse 1.5s infinite;
    }

    .map-overlay {
      position: absolute;
      top: 20px;
      right: 20px;
      background: rgba(0, 0, 0, 0.7);
      padding: 15px;
      border-radius: 10px;
      z-index: 1000;
    }

    .loading-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }

    .loader {
      width: 50px;
      height: 50px;
      border: 5px solid #00bcd4;
      border-radius: 50%;
      border-top-color: transparent;
      animation: spin 1s linear infinite;
    }

    @keyframes titleGlow {
      from { text-shadow: 0 0 10px rgba(0, 188, 212, 0.5); }
      to { text-shadow: 0 0 25px rgba(0, 188, 212, 0.8); }
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.2); }
      100% { transform: scale(1); }
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .floating-controls {
      position: fixed;
      bottom: 30px;
      right: 30px;
      display: flex;
      gap: 15px;
      z-index: 1000;
    }

    .control-btn {
      background: rgba(0, 188, 212, 0.9);
      padding: 15px;
      border-radius: 50%;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 5px 15px rgba(0, 188, 212, 0.3);
    }

    .control-btn:hover {
      transform: translateY(-3px) scale(1.1);
      box-shadow: 0 8px 25px rgba(0, 188, 212, 0.5);
    }

    .floating-cards {
  position: absolute;
  top: 150px;
  left: 10px;
  z-index: 1000;
  display: flex;
  flex-direction: column;
  gap: 10px;
  animation: slideIn 1s ease-out forwards;
  opacity: 0;
}

.floating-cards .card {
  padding: 20px 15px;
  background-color: rgba(0, 0, 0, 0.6);
  color: white;
  border-radius: 10px;
  font-size: 14px;
  min-width: 130px;
  box-shadow: 0 4px 12px rgba(45, 12, 146, 0.4);
  transition: transform 0.3s ease, background-color 0.3s ease;
  transform: translateY(5px);
}

.floating-cards .card:hover {
  transform: translateY(-3px) scale(1.02);
  background-color: rgba(0, 0, 0, 0.8);
}

body.light-mode .floating-cards .card {
  background-color: rgba(255, 255, 255, 0.9);
  color: black;
}

body.light-mode .floating-cards .card:hover {
  background-color: #ffffff;
}

/* Slide-in animation */
@keyframes slideIn {
  0% {
    opacity: 0;
    transform: translateX(-30px);
  }
  100% {
    opacity: 1;
    transform: translateX(0);
  }
}
.control-btn:last-child {
  background-color: #e53935 !important;
  color: white;
}


  </style>
  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
  <script src="firebaseConfig.js"></script>
</head>
<body>
  <div class="loading-screen" id="loadingScreen">
    <div class="loader"></div>
  </div>

  <h1> Fog Road Safety System</h1>
  <div id="map"></div>
  <div id="alertBox">‚ö†Ô∏è WARNING: Another vehicle is within 1 KM!</div>
 
  <div class="floating-cards">
    <div class="card" id="speedCard">Speed: 0 km/h</div>
    <div class="card" id="coordCard">Lat: 0, Lng: 0</div>
    <div class="card" id="nearbyCard">Nearby Vehicles: 0</div>
  </div>
  <div class="floating-controls">
    <div class="control-btn" onclick="refreshPage()">üîÑ</div>
    <div class="control-btn" onclick="centerMap()">üìç</div>
    <div class="control-btn" onclick="toggleAlerts()">ü§ç</div>
    <div class="control-btn" onclick="toggleBreakdown()">üõ†Ô∏è</div> <!-- NEW -->
    <div class="control-btn" onclick="handleEmergency()">sos</div>

  </div>

  <audio id="alertSound" src="beep.mp3" preload="auto"></audio>

  <!-- Load Google Maps API first -->
  <script async defer 
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCeQ_yL8idO59wW7s8qlmZb3bKkJnjK1D8&callback=initMap&v=weekly">
  </script>

  <script>
    // Add these to your existing script.js
    function centerMap() {
       console.log("centerMap called");
         if (map && myLocation) {
            map.panTo(myLocation);
         map.setZoom(15);
         setTimeout(() => map.setZoom(14), 500);
        } else {
         console.log("map or myLocation not ready");
         }
        }


    function toggleAlerts() {
      const btn = document.querySelector('.control-btn:nth-child(2)');
      alertsMuted = !alertsMuted;
      btn.textContent = alertsMuted ? 'üîî' : 'üîï';
      btn.style.background = alertsMuted ? '#00C851' : '#00bcd4';
    }
    function refreshPage() {
      window.location.reload(); // This refreshes only the current page

    }
    let isBreakdown = false;

function toggleBreakdown() {
  isBreakdown = !isBreakdown;
  updateLocation();
  alert(isBreakdown ? "Marked as Breakdown Vehicle" : "Breakdown Cleared");
}

  </script>
  
  <!-- Then your application script -->
  <script src="script.js"></script>
  
</body>
</html>